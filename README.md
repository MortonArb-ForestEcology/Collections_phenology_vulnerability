# Collection phenology vulnerability
Scripts for our collection phenology vulnerability paper for the new climate change ecology special edition on phenology

# Scripts

## Arboretum

## 0_GetPhenologyList_US_Oaks

Purpose: This script serves to create a list of the oak species that we are interested in working with

Inputs: The googlesheet "Quercus Collection Metadata" 

Outputs: dat.oak dataframe that contains the names of the species of interest


## 1_Pull_Data_Pheno.R 

Purpose: This script serves as the initial data download and organization of the arb data

Inputs: Quercus 2018 to present phenology monitoring data from the googlesheet "Phenology_Observations_GoogleForm" in the "LivingCollections-Phenology/Data_Observations/" folder

The clean_google_form.r script which defines the clean.google function.

The group_google_form.r script which defines the group.google function
         
 Outputs: dat.burst dataframe that can be used for the model

dat.leaf dataframe that can be used for the model
          
Notes: Since the original raw data is kept by the authors, most users will not need to run this script. The data frames created by this script are saved in this repository and can be used for the proceeding scripts.


## 2_Pull_Data_weather.R

Purpose: This script serves as the download of weather data and the calculation of relevant weather statistics

Inputs: The weather_calc.r script which defines the weather_calc function.

Outputs: met.all dataframe that can be used to match weather to phenological events

Notes:  This is the script is not neccessary to run as the outputs are stored on the repository


## 3_Pheno_weather_match.R

Purpose: This script serves to combine our weather data with our phenometric data so we can match weather to events. Also to visualize our data since it will be our model input

Inputs:  Oak_collection_budburst_raw.csv

Oak_collection_leaf_raw.csv

GHCN_met_all.csv
         
Outputs: dat.budburst data frame containing first budburst event and weather statistics of interest

dat.leaf data frame containing first budburst event and weather statistics of interest
         
Notes:   This is the script most users will start with as the input data is stored in this repository


## 4_Thermal_Time_model.R

Purpose: This script is the model predicting the GDD5.cum value at which budburst or leaf out occur

Inputs: Oak_collection_budburst.csv
Oak_collection_leaf.csv
         
Outputs: Posterior distributions for bud burst and leaf out for every species in our collection

A data.frame with information on the model run to check convergence  
        
Notes: This script can be made into a loop for each species but is currently manual to allow for checks as it runs


## 5_Model_visualization.R

Purpose: This script combines the posterior distributions of all species so we can look at them as a group

Inputs: Model outputs for all species in the oak collection for budburst and leaf out

Outputs: Various figures and summary statistics

Notes: I break up where we are using budburst and leaf more than in previous scripts for clarity


## 6_ModelValidation_NPNData.R

Purpose: Currently a placeholder script. Will serve purpose of validating our model predictions by checking NPN data on the same species

Notes: The end of the currently completed workflow


# Functions

## clean_google.R

Purpose: A function that will reformat our googlesheets into a useful data format

Inputs: 2018 to present phenology monitoring data from the googlesheet "Phenology_Observations_GoogleForm" 
            
Outputs: A reformatted version of our googlesheet data that is easier to work with


## group_google.R

Purpose: A function that will download all of the google forms of interest

Inputs: 2018 to present phenology monitoring data from the googlesheet "Phenology_Observations_GoogleForm" 

The clean_google_form.r script which defines the clean.google function
        
Outputs: A dataframe containing the information from all desired google forms.

## weather_calc.R

Purpose: This function serves to calculate weather statistics of interest. 

Currently Growing degree days at 5C, Growing degree days at 0C, Number of chill days, and Growing season mean temperature
         
Inputs: Lubridate package

Outputs:This function will take a data frame of daily weather data and produce the following summary statistics

GDD5 = Growing degree days at 5 degrees C 

GDD0 = Growing degree days at 0 degrees C

NCD = Number of chilling days 

GTmean = Growing season mean temperature
  
Notes: The defaults for this funcion are

Starting year of interest                       y_start = 1975

Ending year of interest                         y_end = 2019

Julian yday for start of growing season         g_start = 1

Julian yday for end of growing season           g_end = 120

