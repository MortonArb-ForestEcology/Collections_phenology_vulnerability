#----------------------------------------------------------------------------------------------------------------------------------#
# Script by: Lucien Fitzpatrick
# Project: Collection phenology vulnerability
# Purpose: This script is a visualization graveyard to save code from older visualizations
# Inputs: Dependent on which visualizations you are looking at. The neccessary script is above each visualization section 
# Outputs:Visualizations
# Notes: Currently has old visualizations from script 3, 5, and 9
#-----------------------------------------------------------------------------------------------------------------------------------#

#----------------------------------------------#
#FROM SCRIPT 9#
#----------------------------------------------#

#Exploratory plot of error rate
ggplot(comb.burst, aes(x = error))+
  facet_wrap(~species) +
  geom_histogram() 

#Histogram of distirubtion of difference between observed and predicted
path.figures <- "../figures/Arb_pheno/"
png(width= 750, filename= file.path(path.figures, paste0('Budburst NPN Validation Yday diff', '.png')))
ggplot(comb.burst, aes(x = diff))+
  facet_wrap(~species) +
  geom_histogram() +
  ggtitle('Difference in Observed Yday from Predicted Yday')
dev.off()

#same histogram but with absolute difference
#ggplot(comb.burst, aes(x = absdiff))+
facet_wrap(~species) +
  geom_histogram() 

#Scatter plot to compare 1:1 line between Prediction and Yday
png(width= 750, filename= file.path(path.figures, paste0('NPN Validation scatter budburst', '.png')))
ggplot(comb.burst, aes(x = Yday, y = mid))+
  facet_wrap(~species) +
  geom_point(aes( color = latitude)) +
  geom_errorbar(aes(ymin=tail, ymax=head), width=.2,
                position=position_dodge(0.05))+
  geom_smooth(method='lm', se = FALSE, linetype = "dashed")+
  geom_abline(intercept = 0, slope = 1)+
  scale_color_continuous(type = "viridis")+
  xlim(0, 220)+ylim(0, 220)+
  ggtitle('Observed Yday of budburst vs. predicted') +
  xlab("Observed Yday")+
  ylab("Predicted Yday")
dev.off()

#Map of where the sites in our data are located
map.us <- map_data("state")
png(paste0(path.figures, "NPN Quercus Map BudBurst.png", sep=""), height=6, width=8, units="in", res=180)
ggplot() +
  coord_fixed(1.3) +
  ggtitle(paste("NPN Quercus Breaking Leaf Buds", sep=" ")) +
  geom_polygon(data=map.us, aes(x=long, y=lat, group=group), fill=NA, color="black") +
  geom_point(data=dat.budburst, aes(x=longitude, y=latitude, color=species), alpha=0.75) +
  facet_wrap(~species)+
  #scale_color_continuous(type = "viridis") +
  #scale_size_continuous()+
  labs(color = "Log of GDD5.cum THreshold",size="Number of Observations") +
  theme(panel.background = element_blank(),
        panel.grid = element_blank(),
        axis.text=element_blank(),
        axis.title=element_blank(),
        axis.ticks = element_blank())
dev.off()

png(paste0(path.figures, "NPN Quercus Map BudBurst Resid.png", sep=""), height=6, width=8, units="in", res=180)
ggplot() +
  coord_fixed(1.3) +
  ggtitle(paste("NPN Quercus Breaking Leaf Buds", sep=" ")) +
  geom_polygon(data=map.us, aes(x=long, y=lat, group=group), fill="gray50", color="black") +
  geom_point(data=comb.burst, aes(x=longitude, y=latitude, color=diff), alpha=0.75) +
  facet_wrap(~species)+
  scale_color_gradient2(low="#fc8d59", high="#91bfdb", mid="#ffffbf") +
  #scale_color_continuous(type = "viridis") +
  #scale_size_continuous()+
  labs(color = "Resid") +
  theme(panel.background = element_blank(),
        panel.grid = element_blank(),
        axis.text=element_blank(),
        axis.title=element_blank(),
        axis.ticks = element_blank())
dev.off()

#---------------------------------------------#
#Here begins the leaf out section
#---------------------------------------------#
#This section is identical to the above section save for being about leaf out data


#histogram of error (only 1 or 0)
ggplot(comb.leaf, aes(x = error))+
  facet_wrap(~species) +
  geom_histogram() 

#histogram of diff
path.figures <- "../figures/Arb_pheno/"
png(width= 750, filename= file.path(path.figures, paste0('Leaf NPN Validation Yday diff', '.png')))
ggplot(comb.burst, aes(x = diff))+
  facet_wrap(~species) +
  geom_histogram() +
  ggtitle('Difference in Observed Yday from Predicted Yday')
dev.off()

#Histogram of absdiff
ggplot(comb.leaf, aes(x = absdiff))+
  facet_wrap(~species) +
  geom_histogram() 

#Scatter plot testing 1:1 line
png(width= 750, filename= file.path(path.figures, paste0('NPN Validation scatter leaf', '.png')))
ggplot(comb.leaf, aes(x = Yday, y = mid))+
  facet_wrap(~species) +
  geom_point() +
  geom_smooth(method='lm', se = FALSE, linetype = "dashed")+
  geom_abline(intercept = 0, slope = 1)+
  xlim(0, 220)+ylim(0, 220)+
  geom_errorbar(aes(ymin=tail, ymax=head), width=.2,
                position=position_dodge(0.05))+
  ggtitle('Observed Yday of leaf vs. predicted') +
  xlab("Observed Yday")+
  ylab("Predicted Yday")
dev.off()

#Map of sites we are using
map.us <- map_data("state")
png(file.path(path.figures, "NPN Quercus Map leaf.png"), height=6, width=8, units="in", res=180)
ggplot() +
  coord_fixed(1.3) +
  ggtitle(paste("NPN Quercus Breaking Leaf Buds", sep=" ")) +
  geom_polygon(data=map.us, aes(x=long, y=lat, group=group), fill=NA, color="black") +
  geom_point(data=dat.leaf, aes(x=longitude, y=latitude, color=species), alpha=0.75) +
  facet_wrap(~species)+
  #scale_color_continuous(type = "viridis") +
  #scale_size_continuous()+
  labs(color = "Log of GDD5.cum THreshold",size="Number of Observations") +
  theme(panel.background = element_blank(),
        panel.grid = element_blank(),
        axis.text=element_blank(),
        axis.title=element_blank(),
        axis.ticks = element_blank())
dev.off()


png(file.path(path.figures, "NPN Quercus Map Leaf Resid.png"), height=6, width=8, units="in", res=180)
ggplot() +
  coord_fixed(1.3) +
  ggtitle(paste("NPN Quercus Leaf Out", sep=" ")) +
  geom_polygon(data=map.us, aes(x=long, y=lat, group=group), fill="gray50", color="black") +
  geom_point(data=comb.leaf, aes(x=longitude, y=latitude, color=diff), alpha=0.75) +
  facet_wrap(~species)+
  scale_color_gradient2(low="#fc8d59", high="#91bfdb", mid="#ffffbf") +
  #scale_color_continuous(type = "viridis") +
  #scale_size_continuous()+
  labs(color = "Resid") +
  theme(panel.background = element_blank(),
        panel.grid = element_blank(),
        axis.text=element_blank(),
        axis.title=element_blank(),
        axis.ticks = element_blank())
dev.off()
