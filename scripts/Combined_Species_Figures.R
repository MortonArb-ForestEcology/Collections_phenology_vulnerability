#Plots that combine species trends into one plot.
#First, run script 9 to create the comb.burst and comb.leaf dataframes.

#Creating a new df that adds a 'predicted - observed' column from the comb.burst and comb.leaf dataframes

bud_pred_minus_obs <- mutate(comb.burst, predicted-observed = mid - Yday)

leaf_pred_minus_obs <- mutate(comb.leaf, predicted-observed = mid - Yday)

#Bud Predicted - Observed vs. Latitude Combined
png(width = 800, filename= file.path(path.figures, paste0('Smoothed Combined Bud Predicted - Observed', '.png')))
ggplot(bud_pred_minus_obs, aes(x = latitude, y = predicted_minus_observed, color = species))+
  geom_smooth(method='lm', se = FALSE, linetype = "dashed")+
  ggtitle('Smoothed Combined Budburst Predicted Minus Observed vs Latitude') +
  xlab("Latitude")+
  ylab("Predicted - Observed")
dev.off()

#Leaf Predicted - Observed vs Latitude Combined
png(width = 800, filename= file.path(path.figures, paste0('Smoothed Combined Leaf Predicted - Observed', '.png')))
ggplot(leaf_pred_minus_obs, aes(x = latitude, y = predicted_minus_observed, color = species))+
  geom_smooth(method='lm', se = FALSE, linetype = "dashed")+
  ggtitle('Smoothed Combined Leafout Predicted Minus Observed vs Latitude') +
  xlab("Latitude")+
  ylab("Predicted - Observed")
dev.off()

#Bud Predicted - Observed vs. Observed
png(width = 800, filename= file.path(path.figures, paste0('Smoothed Combined Bud Predicted - Observed vs Observed', '.png')))
ggplot(bud_pred_minus_obs, aes(x = Yday, y = predicted_minus_observed, color=species))+
  geom_smooth(method='lm', se = FALSE, linetype = "dashed")+
  #facet_wrap(~species) + #add this to group plots by individual species (not combined)
  xlim(0, 220)+ylim(-100, 50)+
  ggtitle('Smoothed Combined Leafout Predicted Minus Observed vs Observed') +
  xlab("Observed Yday")+
  ylab("Predicted - Observed")
dev.off()

#Leaf Predicted - Observed vs. Observed
png(width = 800, filename= file.path(path.figures, paste0('Smoothed Combined Leaf Predicted - Observed vs Observed', '.png')))
ggplot(leaf_pred_minus_obs, aes(x = Yday, y = predicted_minus_observed, color=species))+
  geom_smooth(method='lm', se = FALSE, linetype = "dashed")+
  #facet_wrap(~species) + #add this to group plots by individual species (not combined)
  xlim(0, 220)+ylim(-100, 50)+
  ggtitle('Smoothed Combined Leafout Predicted Minus Observed vs Observed') +
  xlab("Observed Yday")+
  ylab("Predicted - Observed")
dev.off()

#Bud Predicted vs. Observed Combined 
png(width = 800, filename= file.path(path.figures, paste0('Smoothed Combined Bud NPN Validation', '.png')))
ggplot(comb.burst, aes(x = Yday, y = mid, color=species))+
  geom_smooth(method='lm', se = FALSE, linetype = "dashed")+
  geom_abline(intercept = 0, slope = 1)+
  ggtitle('Smoothed Combined Bud NPN Validation') +
  xlab("Observed Yday")+
  ylab("Predicted Yday")
dev.off()

#Leaf Predicted vs. Observed Combined 
png(width = 800, filename= file.path(path.figures, paste0('Smoothed Combined Leaf NPN Validation', '.png')))
ggplot(comb.leaf, aes(x = Yday, y = mid, color=species))+
  geom_smooth(method='lm', se = FALSE, linetype = "dashed")+
  geom_abline(intercept = 0, slope = 1)+
  ggtitle('Smoothed Combined Leaf NPN Validation') +
  xlab("Observed Yday")+
  ylab("Predicted Yday")
dev.off()

