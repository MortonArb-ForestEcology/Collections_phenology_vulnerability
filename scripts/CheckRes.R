# CHeck residuals and homoscedacity
bud.gdd <- read.csv(file.path(path.data, 'First_Budburst_Prediction_Evaluation_all.csv'), stringsAsFactors = T)
bud.lat <- read.csv(file.path(path.data, 'ReVLat_Budburst_Prediction_Evaluation_all.csv'), stringsAsFactors = T)
bud.gt <- read.csv(file.path(path.data, 'ReVGT_Budburst_Prediction_Evaluation_all.csv'), stringsAsFactors = T)
bud.gdd$Model <- "GDD"
bud.lat$Model <- "Lat"
bud.gt $Model <- "GT"



bud.keep <- c("species", "site_id", "individual_id", "year", "latitude", "longitude", "first.min", "Yday", "mid", "Date", "diff", "expdiff", "error", "type", "Model")
bud.long <- rbind(bud.gdd[,bud.keep], 
                  bud.lat[,bud.keep], 
                  bud.gt[,bud.keep])
bud.long$Model <- factor(bud.long$Model, levels=c("GDD", "Lat", "GT"))
summary(bud.long)

ggplot(data=bud.long[bud.long$Model=="GDD",]) +
  facet_wrap(~species, scales="free") +
  geom_histogram(aes(x=Yday))

arb.lat = 41.82
arb.lon = -88.04

ggplot(data=bud.gt) +
  facet_wrap(~species, scales="free") +
  geom_point(x=arb.lon, y=arb.lat, color="green3", size=2.5) +
  geom_point(aes(x=longitude, y=latitude)) 


ggplot(data=bud.long) +
  facet_grid(. ~ Model, scales="free_y") +
  geom_histogram(aes(x=diff, fill=type)) 

ggplot(data=bud.long) +
  facet_grid(type ~ Model, scales="free_y") +
  geom_point(aes(x=Yday, y=mid, color=type)) +
  # geom_abline() +
  geom_abline(slope=1, intercept=0, linetype="dashed")


ggplot(data=bud.long) +
  facet_grid(type ~ Model, scales="free_y") +
  geom_point(aes(x=Yday, y=diff, color=type)) +
  geom_hline(yintercept=0) #+
  # geom_abline(slope=1, intercept=0, linetype="dashed")

